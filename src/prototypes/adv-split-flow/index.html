<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Variant D: Split Flow</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #fef9f3 0%, #f5e6d3 100%);
            height: 100vh;
            overflow: hidden;
            display: flex;
        }

        /* Left Configuration Panel */
        .config-panel {
            width: 280px;
            background: white;
            border-right: 2px solid #d4a574;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 24px;
            overflow-y: auto;
        }

        .section-title {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #8b6f47;
            margin-bottom: 8px;
            padding-bottom: 4px;
            border-bottom: 1px solid #e8d4b8;
        }

        .step-header {
            font-size: 13px;
            font-weight: 700;
            color: #5a4527;
            padding: 8px 12px;
            background: #fef4e6;
            border-left: 3px solid #d4a574;
            margin-bottom: 16px;
        }

        /* Product Chips */
        .product-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .product-chip {
            width: 56px;
            height: 56px;
            border: 2px solid #e8d4b8;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            background: white;
            transition: all 0.2s;
        }

        .product-chip:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(212, 165, 116, 0.2);
        }

        .product-chip.selected {
            border-color: #d4a574;
            border-width: 3px;
            background: #fffbf5;
            box-shadow: 0 0 0 2px rgba(212, 165, 116, 0.3);
        }

        /* Demographics Tags */
        .demo-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .demo-tag {
            padding: 6px 12px;
            border: 1px solid #d4a574;
            border-radius: 16px;
            font-size: 12px;
            cursor: pointer;
            background: white;
            color: #5a4527;
            transition: all 0.2s;
        }

        .demo-tag:hover {
            background: #fef4e6;
        }

        .demo-tag.active {
            background: #d4a574;
            color: white;
            font-weight: 600;
        }

        /* Semantic Input */
        .semantic-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #d4a574;
            border-radius: 6px;
            font-size: 13px;
            font-family: inherit;
            background: white;
        }

        .semantic-input:focus {
            outline: none;
            border-color: #b8935f;
            box-shadow: 0 0 0 3px rgba(212, 165, 116, 0.1);
        }

        /* Buttons */
        .action-btn {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: #d4a574;
            color: white;
        }

        .btn-primary:hover {
            background: #b8935f;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(212, 165, 116, 0.3);
        }

        .btn-secondary {
            background: white;
            color: #5a4527;
            border: 2px solid #d4a574;
        }

        .btn-secondary:hover {
            background: #fef4e6;
        }

        .btn-success {
            background: #6b8e4e;
            color: white;
        }

        .btn-success:hover {
            background: #5a7741;
        }

        /* Right Preview Panel */
        .preview-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 20px;
            gap: 16px;
        }

        .preview-main {
            flex: 1;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }

        .preview-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .preview-placeholder {
            text-align: center;
            color: #8b6f47;
        }

        .preview-placeholder-icon {
            font-size: 64px;
            margin-bottom: 16px;
        }

        /* Thumbnail Strip */
        .thumbnail-strip {
            height: 80px;
            background: white;
            border-radius: 8px;
            padding: 10px;
            display: flex;
            gap: 10px;
            overflow-x: auto;
            overflow-y: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
        }

        .thumbnail {
            min-width: 60px;
            height: 60px;
            border: 2px solid #e8d4b8;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            background: #fafafa;
            transition: all 0.2s;
            font-size: 11px;
            color: #8b6f47;
        }

        .thumbnail:hover {
            border-color: #d4a574;
            transform: scale(1.05);
        }

        .thumbnail.active {
            border-color: #d4a574;
            border-width: 3px;
            box-shadow: 0 0 0 2px rgba(212, 165, 116, 0.2);
        }

        /* Split Comparison View */
        .split-comparison {
            display: none;
            flex: 1;
            gap: 16px;
        }

        .split-comparison.active {
            display: flex;
        }

        .comparison-side {
            flex: 1;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .comparison-label {
            padding: 12px;
            background: #fef4e6;
            font-size: 12px;
            font-weight: 600;
            text-align: center;
            color: #5a4527;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .comparison-image {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .comparison-image img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        /* Toggle Controls */
        .toggle-controls {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin-top: 12px;
        }

        .toggle-btn {
            padding: 8px 16px;
            border: 1px solid #d4a574;
            border-radius: 6px;
            background: white;
            color: #5a4527;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .toggle-btn:hover {
            background: #fef4e6;
        }

        .toggle-btn.active {
            background: #d4a574;
            color: white;
        }

        /* State Messages */
        .state-message {
            padding: 12px;
            background: #e8f4fd;
            border-left: 3px solid #4a9eff;
            border-radius: 4px;
            font-size: 12px;
            color: #2c5f8d;
            margin-bottom: 12px;
        }

        /* Scrollbar Styling */
        .thumbnail-strip::-webkit-scrollbar {
            height: 6px;
        }

        .thumbnail-strip::-webkit-scrollbar-track {
            background: #f5e6d3;
            border-radius: 3px;
        }

        .thumbnail-strip::-webkit-scrollbar-thumb {
            background: #d4a574;
            border-radius: 3px;
        }

        .config-panel::-webkit-scrollbar {
            width: 6px;
        }

        .config-panel::-webkit-scrollbar-track {
            background: #f5e6d3;
        }

        .config-panel::-webkit-scrollbar-thumb {
            background: #d4a574;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <!-- Left Configuration Panel -->
    <div class="config-panel">
        <div class="step-header">Step 1 - Generate Posts</div>

        <div>
            <div class="section-title">Products</div>
            <div class="product-chips">
                <div class="product-chip" data-product="chair">ü™ë</div>
                <div class="product-chip" data-product="lamp">üèÆ</div>
                <div class="product-chip" data-product="books">üìö</div>
                <div class="product-chip" data-product="candle">üïØÔ∏è</div>
            </div>
        </div>

        <div>
            <div class="section-title">Demographics</div>
            <div class="demo-tags">
                <div class="demo-tag" data-demo="18-24">18-24</div>
                <div class="demo-tag" data-demo="25-34">25-34</div>
                <div class="demo-tag" data-demo="35-44">35-44</div>
                <div class="demo-tag" data-demo="45-54">45-54</div>
                <div class="demo-tag" data-demo="urban">Urban</div>
                <div class="demo-tag" data-demo="suburban">Suburban</div>
            </div>
        </div>

        <div>
            <div class="section-title">Semantic Context</div>
            <input type="text" class="semantic-input" placeholder="e.g., cozy home vibes, modern minimalist...">
        </div>

        <button class="action-btn btn-primary" id="generateBtn">Generate Posts</button>

        <div class="step-header" style="margin-top: 8px;">Step 2 - Test & Deploy</div>

        <button class="action-btn btn-secondary" id="testPlacementBtn" disabled>Test Placement</button>
        <button class="action-btn btn-success" id="deployBtn" disabled>Deploy Campaign</button>
    </div>

    <!-- Right Preview Panel -->
    <div class="preview-panel">
        <div class="preview-main" id="previewMain">
            <div class="preview-placeholder">
                <div class="preview-placeholder-icon">üé®</div>
                <p>Select products and click "Generate Posts"</p>
                <p style="font-size: 12px; margin-top: 8px; color: #b8935f;">Generated posts will appear here</p>
            </div>
        </div>

        <!-- Split Comparison View (hidden initially) -->
        <div class="split-comparison" id="splitComparison">
            <div class="comparison-side">
                <div class="comparison-label">Original Post</div>
                <div class="comparison-image">
                    <div style="text-align: center; color: #8b6f47;">
                        <div style="font-size: 48px; margin-bottom: 12px;">üì∏</div>
                        <p>Original social media post</p>
                    </div>
                </div>
            </div>
            <div class="comparison-side">
                <div class="comparison-label">With Product Placement</div>
                <div class="comparison-image">
                    <div style="text-align: center; color: #8b6f47;">
                        <div style="font-size: 48px; margin-bottom: 12px;">‚ú®</div>
                        <p>Post with product integrated</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="thumbnail-strip" id="thumbnailStrip">
            <!-- Thumbnails will be dynamically added here -->
        </div>
    </div>

    <script>
        // State management
        let state = {
            selectedProducts: new Set(),
            selectedDemos: new Set(),
            generatedPosts: [],
            currentView: 'preview', // 'preview' or 'comparison'
            activeThumbnail: null
        };

        // DOM Elements
        const productChips = document.querySelectorAll('.product-chip');
        const demoTags = document.querySelectorAll('.demo-tag');
        const generateBtn = document.getElementById('generateBtn');
        const testPlacementBtn = document.getElementById('testPlacementBtn');
        const deployBtn = document.getElementById('deployBtn');
        const previewMain = document.getElementById('previewMain');
        const splitComparison = document.getElementById('splitComparison');
        const thumbnailStrip = document.getElementById('thumbnailStrip');

        // Product Selection
        productChips.forEach(chip => {
            chip.addEventListener('click', () => {
                const product = chip.dataset.product;
                if (state.selectedProducts.has(product)) {
                    state.selectedProducts.delete(product);
                    chip.classList.remove('selected');
                } else {
                    state.selectedProducts.add(product);
                    chip.classList.add('selected');
                }
            });
        });

        // Demographics Selection
        demoTags.forEach(tag => {
            tag.addEventListener('click', () => {
                const demo = tag.dataset.demo;
                if (state.selectedDemos.has(demo)) {
                    state.selectedDemos.delete(demo);
                    tag.classList.remove('active');
                } else {
                    state.selectedDemos.add(demo);
                    tag.classList.add('active');
                }
            });
        });

        // Generate Posts
        generateBtn.addEventListener('click', () => {
            if (state.selectedProducts.size === 0) {
                alert('Please select at least one product');
                return;
            }

            // Simulate post generation
            generatePosts();
        });

        function generatePosts() {
            // Simulate 6 generated posts
            state.generatedPosts = Array.from({ length: 6 }, (_, i) => ({
                id: i + 1,
                thumbnail: `Post ${i + 1}`,
                emoji: ['üåÖ', 'üè°', '‚òï', 'üåø', 'üìñ', 'üõãÔ∏è'][i]
            }));

            // Update thumbnail strip
            renderThumbnails();

            // Show first post in preview
            showPreview(0);

            // Enable test placement button
            testPlacementBtn.disabled = false;
            deployBtn.disabled = false;

            // Show success message
            showSuccessMessage();
        }

        function renderThumbnails() {
            thumbnailStrip.innerHTML = state.generatedPosts.map((post, index) => `
                <div class="thumbnail ${index === 0 ? 'active' : ''}" data-index="${index}">
                    <div style="text-align: center;">
                        <div style="font-size: 20px;">${post.emoji}</div>
                        <div style="font-size: 9px; margin-top: 2px;">${post.id}</div>
                    </div>
                </div>
            `).join('');

            // Add click handlers to thumbnails
            document.querySelectorAll('.thumbnail').forEach(thumb => {
                thumb.addEventListener('click', () => {
                    const index = parseInt(thumb.dataset.index);
                    showPreview(index);
                });
            });
        }

        function showPreview(index) {
            state.activeThumbnail = index;
            const post = state.generatedPosts[index];

            // Update active thumbnail
            document.querySelectorAll('.thumbnail').forEach((thumb, i) => {
                thumb.classList.toggle('active', i === index);
            });

            // Show in main preview
            previewMain.style.display = 'flex';
            splitComparison.classList.remove('active');
            state.currentView = 'preview';

            previewMain.innerHTML = `
                <div style="text-align: center;">
                    <div style="font-size: 120px; margin-bottom: 24px;">${post.emoji}</div>
                    <h2 style="color: #5a4527; margin-bottom: 8px;">Generated Post ${post.id}</h2>
                    <p style="color: #8b6f47; font-size: 14px;">Click "Test Placement" to see product integration</p>
                </div>
            `;
        }

        function showSuccessMessage() {
            const existingMsg = document.querySelector('.state-message');
            if (existingMsg) existingMsg.remove();

            const message = document.createElement('div');
            message.className = 'state-message';
            message.textContent = `‚úì Generated ${state.generatedPosts.length} posts for ${state.selectedProducts.size} product(s)`;

            const configPanel = document.querySelector('.config-panel');
            const firstStepHeader = document.querySelector('.step-header');
            firstStepHeader.after(message);

            setTimeout(() => message.remove(), 5000);
        }

        // Test Placement
        testPlacementBtn.addEventListener('click', () => {
            if (state.currentView === 'preview') {
                // Switch to comparison view
                previewMain.style.display = 'none';
                splitComparison.classList.add('active');
                state.currentView = 'comparison';
                testPlacementBtn.textContent = 'Back to Preview';

                // Update comparison view with current post
                updateComparisonView();
            } else {
                // Switch back to preview
                previewMain.style.display = 'flex';
                splitComparison.classList.remove('active');
                state.currentView = 'preview';
                testPlacementBtn.textContent = 'Test Placement';
            }
        });

        function updateComparisonView() {
            const post = state.generatedPosts[state.activeThumbnail];
            const selectedProductsArray = Array.from(state.selectedProducts);

            splitComparison.innerHTML = `
                <div class="comparison-side">
                    <div class="comparison-label">Original Post</div>
                    <div class="comparison-image">
                        <div style="text-align: center;">
                            <div style="font-size: 80px; margin-bottom: 16px;">${post.emoji}</div>
                            <p style="color: #8b6f47;">Post ${post.id}</p>
                        </div>
                    </div>
                </div>
                <div class="comparison-side">
                    <div class="comparison-label">With Product: ${selectedProductsArray[0] || 'N/A'}</div>
                    <div class="comparison-image">
                        <div style="text-align: center;">
                            <div style="font-size: 80px; margin-bottom: 16px;">${post.emoji}${getProductEmoji(selectedProductsArray[0])}</div>
                            <p style="color: #8b6f47;">Post ${post.id} + Product</p>
                        </div>
                    </div>
                </div>
            `;

            // Add toggle controls if multiple products selected
            if (selectedProductsArray.length > 1) {
                const toggleControls = document.createElement('div');
                toggleControls.className = 'toggle-controls';
                toggleControls.innerHTML = selectedProductsArray.map((product, i) => `
                    <button class="toggle-btn ${i === 0 ? 'active' : ''}" data-product="${product}">
                        ${getProductEmoji(product)} ${product}
                    </button>
                `).join('');

                splitComparison.appendChild(toggleControls);

                // Add click handlers
                toggleControls.querySelectorAll('.toggle-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        toggleControls.querySelectorAll('.toggle-btn').forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');

                        const product = btn.dataset.product;
                        const comparisonSide = splitComparison.querySelectorAll('.comparison-side')[1];
                        comparisonSide.querySelector('.comparison-label').textContent = `With Product: ${product}`;
                        comparisonSide.querySelector('.comparison-image').innerHTML = `
                            <div style="text-align: center;">
                                <div style="font-size: 80px; margin-bottom: 16px;">${post.emoji}${getProductEmoji(product)}</div>
                                <p style="color: #8b6f47;">Post ${post.id} + Product</p>
                            </div>
                        `;
                    });
                });
            }
        }

        function getProductEmoji(product) {
            const emojiMap = {
                'chair': 'ü™ë',
                'lamp': 'üèÆ',
                'books': 'üìö',
                'candle': 'üïØÔ∏è'
            };
            return emojiMap[product] || '';
        }

        // Deploy Campaign
        deployBtn.addEventListener('click', () => {
            if (confirm(`Deploy campaign with ${state.generatedPosts.length} posts for ${state.selectedProducts.size} product(s)?`)) {
                alert('Campaign deployed successfully!');
            }
        });
    </script>
</body>
</html>
